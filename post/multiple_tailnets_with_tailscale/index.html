<!doctypehtml><html lang=ko><link href=https://gravatar.com/avatar/837266b567b50fd59e72428220bf69b1 rel=icon><link href=https://blog.litehell.info/post/multiple_tailnets_with_tailscale rel=canonical><link href=https://blog.litehell.info/post/multiple_tailnets_with_tailscale hreflang=ko rel=alternate><link href=https://blog.litehell.info/post/multiple_tailnets_with_tailscale hreflang=en rel=alternate><link title="RSS 2.0 Feed for LiteHell's blog"href=https://blog.litehell.info/feed/rss rel=alternate type=application/rss+xml><link title="Atom 1.0 Feed for LiteHell's blog"type="	application/atom+xml"href=https://blog.litehell.info/feed/atom rel=alternate><link title="Json 1.0 Feed for LiteHell's blog"href=https://blog.litehell.info/feed/json rel=alternate type=application/feed+json><link href=https://esm.sh/@wooorm/starry-night@3/style/core.css rel=stylesheet><link href=https://esm.sh/@wooorm/starry-night@3/style/both.css rel=stylesheet><link href=https://fonts.googleapis.com rel=preconnect><link crossorigin href=https://fonts.gstatic.com rel=preconnect><link href=https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap rel=stylesheet><meta content="Tailscale을 이용한 두개 이상의 네트워크 만들기"property=og:title><meta content="계정 두개 만들 필요 X"property=og:description><meta content=ko property=og:locale><meta content=blog property=og:type><meta content="LiteHell의 블로그"property=og:site_name><meta content=https://blog.litehell.info/post/multiple_tailnets_with_tailscale property=og:url><meta content=https://blog.litehell.info/single_tailnet.svg property=og:image><meta content=width=device-width,initial-scale=1 name=viewport><style>html,body{margin:0;padding:0;font-family:Noto Sans KR,sans-serif}</style><title>LiteHell의 블로그 - Tailscale을 이용한 두개 이상의 네트워크 만들기</title><body><link as=image href=https://gravatar.com/avatar/837266b567b50fd59e72428220bf69b1 rel=preload><link as=image href=https://i.creativecommons.org/l/by-sa/4.0/88x31.png rel=preload><link as=image href=https://www.gnu.org/graphics/agplv3-with-text-100x42.png rel=preload><style data-emotion="css 17rruta">.css-17rruta{--top-padding:max(40px,3rem);--vertical-padding:max(20px,2em);padding:var(--top-padding)var(--vertical-padding)0em var(--vertical-padding);box-sizing:border-box;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;align-items:center;min-height:100vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}@media (prefers-color-scheme:dark){.css-17rruta{color:#eee;background:#1a1a1a}.css-17rruta a{color:#af7428}.css-17rruta a:hover,.css-17rruta a:active,.css-17rruta a:focus{color:#e98c13}}.css-17rruta>*{width:100%}@media (width>=1024px){.css-17rruta>*{max-width:960px}}.css-17rruta main{-webkit-flex:1;-ms-flex:1;flex:1}.css-17rruta footer{border-top:1px solid #727272;margin:2rem 0 0;padding:1.5rem 0}</style><div class=css-17rruta><style data-emotion="css 1fkv74n">.css-1fkv74n{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;align-items:center;gap:2rem;padding-bottom:1.5rem;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}@media (width<=25rem){.css-1fkv74n{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}}.css-1fkv74n .profileImg a{color:inherit;-webkit-text-decoration:none;text-decoration:none}.css-1fkv74n .profileImg img{border-radius:4rem;width:8rem;height:8rem;box-shadow:0 3px 6px #00000029,0 3px 6px #0000003b}.css-1fkv74n .title h1{word-break:keep-all;margin:0 0 .5rem;padding:0;font-size:2rem;line-height:2.5rem}.css-1fkv74n .title h1 a{color:inherit;-webkit-text-decoration:none;text-decoration:none}.css-1fkv74n .links{margin:0;padding:0;font-size:.9rem;line-height:1.2rem}@media (width<=1023px){.css-1fkv74n .title h1{font-size:1.5rem;line-height:2rem}.css-1fkv74n .rounded img{border-radius:3.5rem 3.4rem;width:7rem;height:7rem}}</style><header class=css-1fkv74n><div class=profileImg><a href=/><img alt="LiteHell의 Gravatar 아이콘"src=https://gravatar.com/avatar/837266b567b50fd59e72428220bf69b1></a></div><div class=title><h1><a href=/>LiteHell의 블로그</a></h1><p class=links>외부고리: <a href=https://github.com/litehell>GitHub</a>, <a href=https://yeonjin.name/portfolio>Portfolio</a><br>내부고리: <a href=/categories>카테고리</a>, <a href=/tags>태그</a><br>다른 언어: <a href=https://blog-en.litehell.info hreflang=en>영어 (English)</a></p><style data-emotion="css ioj8ye">.css-ioj8ye{color:#374c64;font-size:75%}@media (prefers-color-scheme:dark){.css-ioj8ye{color:#999}}</style><p class=css-ioj8ye>글 쓸 때는 AI를 안 씁니다. 전부 직접 씁니다. 만약 오탈자나 어색한 문장이 있다면 퇴고를 대충해서 그런거니 양해 부탁드립니다.<br>블로그의 모든 시간 및 날짜는 별도의 언급이 없다면 한국 표준 시간대입니다.</div></header><main><div><style data-emotion="css 1v4sk1e">.css-1v4sk1e{border-bottom:1px solid #999;margin-bottom:.8rem;padding:1.5rem 0 2rem}.css-1v4sk1e .title{margin-bottom:.25rem}.css-1v4sk1e .title *{margin:0;padding:0;display:inline}.css-1v4sk1e .title h2{font-size:2rem;line-height:2.1rem}.css-1v4sk1e .title h3{margin-left:1rem;font-size:1rem;font-weight:200;line-height:1rem}.css-1v4sk1e .datetime{color:#666;margin:0;padding:0}.css-1v4sk1e .links .description{color:#666}</style><div class=css-1v4sk1e><div class=title><h2>Tailscale을 이용한 두개 이상의 네트워크 만들기</h2><h3>계정 두개 만들 필요 X</h3></div><p class=datetime>2025. 11. 1. 오후 10:28:27에 LiteHell이(가) 작성함.<div class=links><div class=link><span class=description>카테고리: </span><a href=/category/Tor>Tor</a></div><div class=link><span class=description>태그: </span><a href=/tag/Tailscale>Tailscale</a>, <a href=/tag/VPN>VPN</a>, <a href=/tag/Network>Network</a>, <a href=/tag/Infra>Infra</a></div></div></div><style data-emotion="css xljd47">.css-xljd47{padding:10px;font-size:1rem;line-height:180%}@font-face{font-family:D2Coding;src:url(https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_three@1.0/D2Coding.woff)format("woff");font-weight:400;font-display:swap}.css-xljd47 pre{background:#f0f0f0;border-radius:6px;padding:.5em 1em;overflow-x:auto}@media (prefers-color-scheme:dark){.css-xljd47 pre{color:#ebebeb;background:#383838}}.css-xljd47 code{font-family:Fira Code,Source Code Pro,JetBrains Mono,Roboto Mono,DejaVu Sans Mono,DejaVu Mono,Inconsolata,Monaco,Consolas,Hack,Ubuntu Mono,Red Hat Mono,D2 coding,monospace}.css-xljd47 h1{margin:1.8rem 0;font-size:1.8rem}.css-xljd47 h1:before{content:"# ";color:#a19c91}.css-xljd47 h2{margin:1.6rem 0;font-size:1.6rem}.css-xljd47 h2:before{content:"## ";color:#a19c91}.css-xljd47 h3{margin:1.4rem 0;font-size:1.4rem}.css-xljd47 h3:before{content:"### ";color:#a19c91}.css-xljd47 h4{margin:1.2rem 0;font-size:1.2rem}.css-xljd47 h5{margin:1.15rem 0;font-size:1.15rem}.css-xljd47 h5:before{content:"> ";color:#a19c91}.css-xljd47 h6{margin:1.1rem 0;font-size:1.1rem}.css-xljd47 h6:before{content:">> ";color:#a19c91}.css-xljd47 img,.css-xljd47 iframe{max-width:80%;margin:0 auto;display:block}.css-xljd47 table{white-space:nowrap;border-collapse:collapse;display:block;overflow-x:auto}.css-xljd47 table td,.css-xljd47 table tr,.css-xljd47 table th{border:1px solid gray}.css-xljd47 table th{font-weight:700}.css-xljd47 table th,.css-xljd47 table td{padding:5px 10px}.css-xljd47 table thead{background:#d8d8d8}@media (prefers-color-scheme:dark){.css-xljd47 table thead{color:#fff;background:#666}}.css-xljd47 blockquote{background:#c2c2c2;border-left:5px solid #4e4e4e;margin:25px 10px 25px 30px;padding:10px 50px}@media (prefers-color-scheme:dark){.css-xljd47 blockquote{color:#ccc;background:#4f4f4f;border-left:5px solid #cacaca}}.css-xljd47 ul li,.css-xljd47 ol li{margin:6px 0}</style><article class=css-xljd47><h1>들어가는 글</h1><p>필자는 <a href=https://tailscale.com/>Tailscale</a>을 쓴다. Tailscale은 <a href=https://www.wireguard.com/>Wireguard</a>에 기반한 VPN 서비스인데, 직접 VPN 서버를 구축하는 것보다<sup><a aria-describedby=footnote-label data-footnote-ref href=#user-content-fn-1 id=user-content-fnref-1>1</a></sup> 훨씬 편리해서 애용하고 있다.<p><a href=https://asianaonion.org>그러다가 최근에 Tor 릴레이를 본격적으로 시작하게 됐다.</a><sup><a aria-describedby=footnote-label data-footnote-ref href=#user-content-fn-2 id=user-content-fnref-2>2</a></sup> <a href=/post/retrospective_of_2024/>2024년의 회고</a> 글에 고대역폭 Tor 릴레이를 만들어보고 싶다고 적고 알아보다가 사정이 생겨서 일단 국내에 VPS 여러개를 만드는 식으로 시작했다.<sup><a aria-describedby=footnote-label data-footnote-ref href=#user-content-fn-2 id=user-content-fnref-2-2>2</a></sup><p>알다시피, 외부에 노출되는 포트는 최소화하는 게 모범적이다. 특히 SSH 포트라면 더욱 그렇다. 이는 Tailscale로 내부망을 만들면 쉽게 해결된다.<p>Tailscale을 이용하면 기본적으로 다음과 같은 내부망이 구축된다.<p><img alt="Tailscale을 이용한 네트워크"src=./single_tailnet.svg><p>그러나 개인적으로는 Tor 릴레이들의 네트워크는 따로 두고 싶었다. 즉 다음 구성과 같이 네트워크를 구축하고 싶었다.<p><img alt="목표 네트워크 구성도"src=./target_network_struct.svg><p>개인 네트워크와 Tor 네트워크 간에는 분리하되 개인 네트워크내 특정한 기기(이하 "터미널")는 Tor 릴레이에 SSH를 접속할 수 있어야 한다. 그러나 Tor 릴레이는 터미널을 포함한 개인 네트워크에 접속할 수 없어야 한다.<p>Tailscale 계정 2개 만드는 거 말고 다른 방법이 없을까? <a href=https://www.reddit.com/r/Tailscale/comments/10q4ztn/comment/j6nx04c/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button>검색해보니 Tailscale의 ACL 기능을 이용하면 된다고 한다.</a> 한 번 해보자.<h1>ACL을 이용한 분리된 네트워크 분리</h1><p>네트워크를 분리하기 위해서는 서버에 태그를 추가한 뒤 태그를 기준으로 ACL 규칙을 추가해야 한다. 일단 Tailscale에서 Access Control에 들어간다.<p><img alt="Tailscale Access Control 메뉴 위치"src=./ACL%20menu.png><h2>태그 추가</h2><p>Tags 페이지에서 Create tag 버튼을 눌러 태그를 추가한다. 태그 이름이 바뀌면 노드에 태그 다는 작업을 다시 해야 하니 대충 짓지 말자.<p><img alt="Tailscale 태그 목록"src=./tags.png><p>태그를 생성했다면 <code>Edit ACL tags</code> 기능으로 노드에 태그를 단다. 모든 노드에 태그를 달도록 하자.<p><img alt="Tailscale 노드 메뉴"src=./Edit%20ACL%20tags.png><p>설명을 위해 이 글에서는 태그 A와 B가 생성되었으며 모든 노드는 태그 A나 B 둘 중 하나에만 속한다고 가정한다.<h2>ACL 규칙 추가</h2><p>이제 <a href=https://login.tailscale.com/admin/acls/visual/general-access-rules>General Access rules</a> 탭에서 ACL 규칙을 추가하자. 처음 들어가면 다음 기본 ACL 규칙만 있을 것이다. 삭제하자.<p><img alt="기본 ACL 규칙"src=./Default%20ACL.png><p>A 태그가 달린 노드 간의 통신을 무제한 허용하는 ACL 규칙을 추가한다.<p><img alt="A 태그 ACL 규칙"src=./A%20tag%20acl.png><p>B 태그가 달린 노드간에도 똑같이 추가한다.<p><img alt="B 태그 ACL 규칙"src=./B%20tag%20acl.png><p>그러면 다음과 같이 네트워크가 구성된다.<p><img alt="네트워크 A와 B"src=./network%20A%20and%20B.png><p>A의 노드는 B 네트워크내 노드의 존재를 알 수 없으며 그 반대도 동일하다. 따라서 A 네트워크내의 노드와 B 네트워크 내의 노드 간에는 통신할 수 없다.<h2>SSH 터미널 추가</h2><p>약간만 더 응용하면 네트워크 A와 B 내의 노드로 SSH 접속을 할 수 있는 터미널을 추가할 수도 있다. SSH 터미널로 이용할 노드에 <code>terminal</code> 태그를 추가하고 다음 ACL 규칙을 추가한다. (Tailscale내에 <a href=https://login.tailscale.com/admin/acls/file>JSON editor</a>로 편집할 수 있다.)<sup><a aria-describedby=footnote-label data-footnote-ref href=#user-content-fn-3 id=user-content-fnref-3>3</a></sup><pre><code class=language-json>    {
        <span class=pl-ent>"src"</span>: [<span class=pl-s><span class=pl-pds>"</span>tag:terminal<span class=pl-pds>"</span></span>],
        <span class=pl-ent>"dst"</span>: [<span class=pl-s><span class=pl-pds>"</span>tag:A<span class=pl-pds>"</span></span>, <span class=pl-s><span class=pl-pds>"</span>tag:B<span class=pl-pds>"</span></span>],
        <span class=pl-ent>"ip"</span>:  [<span class=pl-s><span class=pl-pds>"</span>tcp:22<span class=pl-pds>"</span></span>],
    }
</code></pre><p>그러면 다음과 같은 네트워크를 구성할 수 있다. Terminal은 A나 B내의 노드로 SSH(TCP 22포트) 접속을 할 수 있다. 그러나 A나 B 내의 노드는 Terminal 노드로 연결할 수 없다.<p><img alt="A-B-Terminal 네트워크 구조도"src=./a%20and%20b%20and%20terminal.png><h1>결론</h1><p>이를 응용하면 들어가는 글에서 밝힌 네트워크 구조를 만들 수 있다. 괜히 귀찮게 Tailscale 계정을 2개 만들 필요가 없다. Tailscale이 참 잘 만들어졌다.<hr><section class=footnotes data-footnotes><h1 class=sr-only id=footnote-label>주석</h1><ol><li id=user-content-fn-1><p>VPN 서버를 직접 구축할 시에는 <a href=https://www.softether.org/>SoftEther VPN</a>, <a href=https://openvpn.net/client/>OpenVPN</a>, <a href=https://www.wireguard.com/>Wireguard</a> 등의 선택지가 있는데 뭘 쓰던 간에 귀찮다는 건 똑같다. <a aria-label="Back to reference 1"class=data-footnote-backref data-footnote-backref href=#user-content-fnref-1>↩</a></p><li id=user-content-fn-2><p>외국의 경우 <a href=https://emeraldonion.org/>Emerald Onion</a>이나 <a href=https://www.menhera.org/>Menhera.org</a>와 같이 AS(Autonomous system)를 할당받아 Tor 릴레이를 운영하는 단체도 있다. 개인적으로도 이를 원했으나 이를 위해선 <a href=https://kinx.net>KINX</a>랑 소통을 해야하기도 하고, 무엇보다 견적이 개인적으로 감당할 수 없을 것 같단 예상이 들어 일단 VPS로 시작했다. <a aria-label="Back to reference 2"class=data-footnote-backref data-footnote-backref href=#user-content-fnref-2>↩</a> <a aria-label="Back to reference 2-2"class=data-footnote-backref data-footnote-backref href=#user-content-fnref-2-2>↩<sup>2</sup></a></p><li id=user-content-fn-3><p>스크린샷 찍기 귀찮아져서 JSON으로 올렸다.ㅎ <a aria-label="Back to reference 3"class=data-footnote-backref data-footnote-backref href=#user-content-fnref-3>↩</a></p></ol></section></article><style data-emotion="css ly0ba3">.css-ly0ba3 .utterances{max-width:100%!important}</style><div class=css-ly0ba3><script label="blog comment"async crossorigin issue-term=multiple_tailnets_with_tailscale repo=LiteHell/litehell-blog src=https://utteranc.es/client.js theme=preferred-color-scheme></script></div><style data-emotion="css eyxei3">.css-eyxei3{-webkit-box-flex-wrap:wrap;-webkit-flex-flow:wrap;-ms-flex-flow:wrap;flex-flow:wrap;justify-content:space-between;gap:1em .5em;width:100%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.css-eyxei3 a{-webkit-text-decoration:none;text-decoration:none}.css-eyxei3 .inner{vertical-align:top;display:inline-block}.css-eyxei3 .inner .title{font-size:1.3em;line-height:1.3rem}.css-eyxei3 .inner .subtitle{margin-top:.2rem;font-size:1rem;font-weight:200;line-height:1rem}.css-eyxei3 .inner .date{font-size:.8em;font-weight:200;line-height:.8rem}.css-eyxei3 .next,.css-eyxei3 .previous{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:.5em;width:max-content;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.css-eyxei3 .next.next,.css-eyxei3 .previous.next{text-align:right;margin-left:auto}.css-eyxei3 .next.previous,.css-eyxei3 .previous.previous{text-align:left}.css-eyxei3 .next .inner,.css-eyxei3 .previous .inner{-webkit-flex:1;-ms-flex:1;flex:1}</style><nav class=css-eyxei3><a class=previous href=/post/xabelfish_into_multi_process_model><div class=arrow>❮</div><div class=inner><div class=title>XabelFish 개발기 - 멀티 프로세스 모델</div><div class=subtitle>귀찮다면 돌아가라</div><div class=date>2025. 11. 16. 오후 8:58:29</div></div></a><a class=next href=/post/wivrn_for_non_steam_windows_games><div class=inner><div class=title>WiVRn로 리눅스에서 非Steam VR 게임 실행하기</div><div class=subtitle>umu launcher와 함께하는 삽질</div><div class=date>2025. 10. 19. 오후 6:20:54</div></div><div class=arrow>❯</div></a></nav></div></main><style data-emotion="css 19fp2wc">.css-19fp2wc{font-size:.75rem;line-height:.9rem}.css-19fp2wc p{margin:0 0 1em;padding:0}.css-19fp2wc .badges{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;gap:1em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.css-19fp2wc .badges img{border-width:0;width:auto;height:3em}</style><footer class=css-19fp2wc><p>Copyright (C) 2020 ~ 2025 Yeonjin Shin (a.k.a. LiteHell), All rights reserved.<br><a href=/license>This blog is free software; For source code and more informations on license and copyrights, Click here.</a><p>Feeds: <a href=/feed/rss>RSS 2.0</a>, <a href=/feed/atom>Atom</a>, <a href=/feed/json>JSON</a><div class=badges><a href=http://creativecommons.org/licenses/by-sa/4.0/ rel=license><img alt="Creative Commons License"src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png><a href=https://www.gnu.org/licenses/agpl-3.0.en.html><img alt="GNU Affero General License Version 3"src=https://www.gnu.org/graphics/agplv3-with-text-100x42.png></a></a></div></footer></div>