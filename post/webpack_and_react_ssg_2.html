<!DOCTYPE html><html lang="ko-KR"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="https://gravatar.com/avatar/837266b567b50fd59e72428220bf69b1"/><link rel="canonical" href="https://blog.litehell.info/post/webpack_and_react_ssg_2"/><link rel="alternate" type="application/rss+xml" title="RSS 2.0 Feed for blog.litehell.info" href="https://blog.litehell.info/feed/rss"/><link rel="alternate" type=" application/atom+xml" title="Atom 1.0 Feed for blog.litehell.info" href="https://blog.litehell.info/feed/atom"/><link rel="alternate" type="application/feed+json" title="Json 1.0 Feed for blog.litehell.info" href="https://blog.litehell.info/feed/json"/><meta property="og:title" content="Webpack과 React를 이용한 정적 웹사이트 만들기 (2)"/><meta property="og:description" content="... + Static HTML Generation = TA-DA!"/><meta property="og:locale" content="ko_KR"/><meta property="og:type" content="article"/><meta property="og:site_name" content="LiteHell의 블로그"/><meta property="og:url" content="https://blog.litehell.info/post/webpack_and_react_ssg_2"/><meta property="og:image" content="https://gravatar.com/avatar/837266b567b50fd59e72428220bf69b1"/><title>LiteHell의 블로그 - <!-- -->Webpack과 React를 이용한 정적 웹사이트 만들기 (2)</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/vs2015.min.css"/><meta name="next-head-count" content="16"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-CZL0E8YDPW"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'G-CZL0E8YDPW', { page_path: window.location.pathname });
            </script><link rel="preload" href="/_next/static/css/27d177a30947857b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/27d177a30947857b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/088d29430e0ecbdb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/088d29430e0ecbdb.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-ad45764ecfcae9e5.js" defer=""></script><script src="/_next/static/chunks/main-ee0cf4b7f81d7c24.js" defer=""></script><script src="/_next/static/chunks/pages/_app-a96cacb95f41a3ef.js" defer=""></script><script src="/_next/static/chunks/996-c5e5aa4c30f33066.js" defer=""></script><script src="/_next/static/chunks/503-25bfb158f613fce4.js" defer=""></script><script src="/_next/static/chunks/pages/post/%5Bid%5D-b722ca2857677f7b.js" defer=""></script><script src="/_next/static/tPvn0ikdnYc2gkfCdDjpk/_buildManifest.js" defer=""></script><script src="/_next/static/tPvn0ikdnYc2gkfCdDjpk/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="Layout_body__O2_kC"><header class="Layout_header__M_IZ8"><div class="Layout_container__z4qWC"><h1><a href="/">LiteHell의 블로그</a></h1><div class="Layout_outLinks__XBNs_">외부고리 : <a href="https://litehell.info">Homepage</a><a href="https://github.com/LiteHell">GitHub</a><a href="https://linkedin.com/in/LiteHell">LinkedIn</a><a href="https://keybase.io/LiteHell">Keybase</a><a href="mailto:litehell@litehell.info">Email</a></div><div class="Layout_inLinks__f7gmD">내부고리 : <a href="/category">카테고리</a><a href="/tag">태그</a></div></div></header><main class="Layout_mainContainer__5WZfx"><div class="Layout_container__z4qWC"><div class="Blog_header__r4wcZ"><div class="Blog_title___OFu6"><h1>Webpack과 React를 이용한 정적 웹사이트 만들기 (2)</h1><h2>... + Static HTML Generation = TA-DA!</h2></div><p>1/10/2023, 5:00:54 AM<!-- -->에 <!-- -->LiteHell<!-- -->이(가) 작성<!-- -->함<br/><span>카테고리 : <a href="/category/Dev">Dev</a><br/></span><span>태그 : <span class="Blog_tag__RW5VK"><a href="/tag/React">React</a></span><br/></span></p></div><div class="Blog_seriesContainer__ii8Fj"><div class="Blog_seriesTitle__DCd_w">(시리즈) <!-- -->Webpack과 React를 이용한 정적 웹사이트 만들기</div><ul><li><a href="/post/webpack_and_react_ssg_1">Webpack과 React를 이용한 정적 웹사이트 만들기 (1)</a></li><li class="Blog_now__E4xgg"><a href="/post/webpack_and_react_ssg_2">Webpack과 React를 이용한 정적 웹사이트 만들기 (2)</a></li><li><a href="/post/webpack_and_react_ssg_3">Webpack과 React를 이용한 정적 웹사이트 만들기 (3)</a></li></ul></div><section class="Blog_article__WZp3G"><h1 id="들어가는-글">들어가는 글</h1>
<p>1편에서와 같이 개발하면 매우 잘 된다, 구조가 단순하기 때문이다. 1편의 방식을 개발했을 때 빌드된 결과물을 보면 다음과 같이 생겼을 것이다.</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- dist/index.html --&gt;</span>
<span class="hljs-comment">&lt;!-- 참고로 이 예시는 예시일뿐이며, 세부사항은 개개인의 상황에 따라 다를 수 있다. --&gt;</span>
<span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Lorem ipsum<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width,initial-scale=1&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span>=<span class="hljs-string">&quot;defer&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;166.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span>=<span class="hljs-string">&quot;defer&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;main.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>

    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
<p>1편에서 번들링된 파일이 script 태그로 삽입되어 HTML 문서가 불려와진 후 모두 끝난 후 실행되는 형태이다. (<code>defer</code>속성은 스크립트가 문서 분석 이후에 실행되도록 한다.)</p>
<p>즉, <strong>CSR(Client-Side Rendering)</strong> 방식이다. body 태그 내에 div 태그를 만들고 해당 태그에 React Component를 렌더링하는 코드가 클라이언트단에서 모두 실행되는 방식이다. 빌드 단계에서 렌더링이 이루어지지 않으며, 빌드 단계에서 이루어지는 것은 오직 코드 번들링뿐이다.</p>
<p>리소스가 한 번만 로드되고 후속 페이지 로드시간이 빠르다는 장점이 있지만 몇가지 단점도 있다.</p>
<ul>
<li>SEO(검색 엔진 최적화)에 불리하다.</li>
<li>초기 페이지 로드시간이 느리며, 다 로드되기 전까진 흰 화면만 뜬다. (필요한 JavaScript와 CSS를 다 불러와야 하기 때문이다.)</li>
</ul>
<p>이러한 단점들을 극복하려면 어떻게 해야할까?</p>
<h2 id="with-react-hydration">with React Hydration</h2>
<p>빌드시에 초기 HTML을 생성하고, 진입 스크립트을 hydration을 하는 방식으로 수정하면 된다. 여기서 hydration이란 ReactDOMServer에 의해 렌더링된 초기 마크업 코드에 이벤트 리스너를 연결(즉, 요약하자면 재활용)하는 것이다.</p>
<p>이 방식을 이용하면 HTML 마크업 코드는 빌드 단계에서 생성되고, 클라이언트단에서는 React가 이미 생성된 HTML 코드에 부착(attach)하여 동작한다. 이 방식의 장점은 다음과 같다.</p>
<ul>
<li>SEO(검색 엔진 최적화)에 유리하다.</li>
<li>JavaScript와 CSS가 다 불려와지기 전까지 흰화면만 뜨는 현상을 수정할 수 있다.</li>
</ul>
<p>이 방식을 채택하기 전에 먼지 어떤 사항을 확인해야 하는지 한 번 알아보자.</p>
<h3 id="유효한-html코드-작성">유효한 HTML코드 작성</h3>
<p>모든 HTML 코드는 유효하게 작성되어야 한다. 예시를 들자면, p태그 안에는 p태그가 들어갈 수 없다.</p>
<p>React hydration을 하기 위해서는, 빌드단에서 생성된 HTML 코드와 React Component가 생성하는 UI 코드가 일치해야 한다. 만약 초기 UI 불일치 오류가 나타난다면, 유효하지 않은 HTML 코드를 작성한 건 아닌지 한 번 확인해봐야 한다.</p>
<h3 id="클라이언트단에서만-작동하는-코드-수정">클라이언트단에서만 작동하는 코드 수정</h3>
<p>Node.js 환경에서 실행되면 오류가 나는 코드가 있다. 이런 코드들은 브라우저 환경에서만 실행되도록 수정해야 한다.</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// 예시</span>

<span class="hljs-keyword">const</span> isBrowser = <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span>

<span class="hljs-keyword">if</span> (isBrowser())
    <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;../some_module_that_works_only_on_browser&#x27;</span>);</code></pre>
<p>또한, 브라우저단에서 결과가 결정되거나 항상 일정하지 않은 코드는 <code>useEffect</code> 등을 이용해 UI가 렌더링된 이후에 실행되도록 수정해야 한다. 
<code>useState</code>와 <code>useEffect</code> 등은 브라우저단에서만 렌더링된다.</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;

<span class="hljs-comment">// 예시</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AreYouKorean</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// const isKorean = navigator.language === &#x27;ko&#x27;;</span>
    <span class="hljs-keyword">const</span> [isKorean, setIsKorean] = useState&lt;<span class="hljs-built_in">boolean</span> | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
    useEffect(<span class="hljs-function">() =&gt;</span> {
        setIsKorean(navigator.language === <span class="hljs-string">&#x27;ko&#x27;</span>);
    });

    <span class="hljs-keyword">let</span> message: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;...&#x27;</span>;
    <span class="hljs-keyword">if</span> (isKorean !== <span class="hljs-literal">null</span>)
        message = isKorean ? <span class="hljs-string">&#x27;한국인이시군요.&#x27;</span> : <span class="hljs-string">&quot;You&#x27;re not Korean!&quot;</span>;
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{ message }<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}</code></pre>
<h3 id="결과가-불명확한-코드-수정">결과가 불명확한 코드 수정</h3>
<p>이런 코드는 당연히 빌드할 때 생긴 초기 UI와 클라이언트 렌더링시의 초기 UI가 서로 다르게 한다. 빌드시 시간의 초 단위가 짝수면 결과는 *Yes!*가 렌더링될텐데, 사용자가 로드할 때 시간이 홀수면 *No!*가 렌더링되니 서로 불일치하다. 이런 코드가 있다면 수정해야 한다.</p>
<pre><code class="hljs language-tsx"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isTimeEven</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> time = (<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()).getSeconds() % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> time ? <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span> Yes! <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span> : <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span> No! <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;
}</code></pre>
<h2 id="hydration-적용">hydration 적용</h2>
<p>위에서 언급한 문제를 모두 수정했다면 hydration시 초기 UI 불일치 오류는 없을 것이다. 이제 hydration을 적용해보자.</p>
<h3 id="진입-스크립트-수정">진입 스크립트 수정</h3>
<p>먼저, hydrate하도록 <code>src/index.tsx</code>를 수정하자.</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// src/index.tsx</span>

<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-dom/client&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;../styles/index.css&#x27;</span>;
<span class="hljs-keyword">import</span> isBrowser <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./isBrowser&#x27;</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Index</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;bg-gray-400&quot;</span>&gt;</span>
      Hello, World!
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}

<span class="hljs-comment">// 만약 브라우저라면</span>
<span class="hljs-keyword">if</span> (isBrowser()) {
    <span class="hljs-comment">// body &gt; #root 태그에</span>
    <span class="hljs-keyword">const</span> rootDiv = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">&#x27;body &gt; #root&#x27;</span>)!;
    <span class="hljs-comment">// hydration이 필요하다면 (빌드 결과물)</span>
    <span class="hljs-keyword">if</span> (rootDiv.classList.contains(<span class="hljs-string">&#x27;hydrate&#x27;</span>)) {
        <span class="hljs-comment">// Index 컴포넌트를 hydrate한다.</span>
        ReactDOM.hydrateRoot(rootDiv, <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Index</span> /&gt;</span></span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-comment">/* 만약 hydration이 필요없다면 (webpack serve) */</span> {
        <span class="hljs-comment">// 그냥 렌더링 한다.</span>
        <span class="hljs-keyword">const</span> root = ReactDOM.createRoot(rootDiv);
        root.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Index</span> /&gt;</span></span>)
    }
}</code></pre>
<p>브라우저 환경 여부를 판단하는 <code>src/isBrowser.ts</code>도 간단하게 작성한다.</p>
<pre><code class="hljs language-ts"><span class="hljs-comment">// src/isBrowser.ts</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isBrowser</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span> &amp;&amp; <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">document</span> !== <span class="hljs-string">&#x27;undefined&#x27;</span>;
}</code></pre>
<p><code>src/index.tsx</code>는 빌드 스크립트에서도 import된다. 따라서 브라우저단에서만 실행되야 하는 코드는 브라우저단에서만 실행되도록 수정해야 한다.</p>
<h3 id="html-템플릿-생성">HTML 템플릿 생성</h3>
<p>그 다음으로, 간단한 HTML 템플릿을 생성한다.</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- src/index.html --&gt;</span>

<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;ko&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf8&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Lorem ipsum<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span>

        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
<h3 id="html-생성-스크립트-추가">HTML 생성 스크립트 추가</h3>
<p>초기 HTML 코드를 생성하는 스크립트를 작성해야 한다. 먼저 스크립트 작성 전에 의존성을 몇가지 설치하자.</p>
<pre><code class="hljs language-bash">yarn add cheerio tmp-promise</code></pre>
<p>그 다음으로, 다음과 같이 스크립트를 작성한다.</p>
<pre><code class="hljs language-tsx"><span class="hljs-comment">// src/generate.tsx</span>

<span class="hljs-keyword">import</span> { load <span class="hljs-keyword">as</span> loadHTML } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;cheerio&#x27;</span>;
<span class="hljs-keyword">import</span> { createWriteStream, promises <span class="hljs-keyword">as</span> fs } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;fs&#x27;</span>;
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> server <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-dom/server&#x27;</span>;
<span class="hljs-keyword">import</span> tmp <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;tmp-promise&#x27;</span>;
<span class="hljs-keyword">import</span> Index <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./index&#x27;</span>;

(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-comment">// 임시 파일을 생성한다.</span>
    <span class="hljs-keyword">const</span> tmpFile = <span class="hljs-keyword">await</span> tmp.file();

    <span class="hljs-comment">// Webpack 번들러에 의해 생성된 HTML 파일의 위치이다.</span>
    <span class="hljs-keyword">const</span> filename = <span class="hljs-string">&#x27;./dist/index.html&#x27;</span>;

    <span class="hljs-comment">// 초기 UI 코드를 생성하는 ReactDOMServer의 스트림이다.</span>
    <span class="hljs-keyword">const</span> reactStream = server.renderToPipeableStream(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Index</span> /&gt;</span></span>);

    <span class="hljs-comment">// 스트림을 임시 파일에 쓴다.</span>
    <span class="hljs-keyword">const</span> fileStream = createWriteStream(tmpFile.path);

    <span class="hljs-comment">// 초기 UI 코드가 임시 파일에 모두 써졌으면</span>
    reactStream.pipe(fileStream).on(<span class="hljs-string">&#x27;finish&#x27;</span>, <span class="hljs-keyword">async</span> () =&gt; {
        <span class="hljs-comment">// 웹팩에 의해 번들링된 HTML 파일을 읽는다.</span>
        <span class="hljs-keyword">const</span> htmlText = <span class="hljs-keyword">await</span> fs.readFile(filename, { <span class="hljs-attr">encoding</span>: <span class="hljs-string">&#x27;utf8&#x27;</span> });

        <span class="hljs-comment">// HTML 파일의 id가 root인 태그에 초기 UI 코드를 넣는다.</span>
        <span class="hljs-keyword">const</span> dom = loadHTML(htmlText);
        dom(<span class="hljs-string">&#x27;body &gt; #root&#x27;</span>).html(<span class="hljs-keyword">await</span> fs.readFile(tmpFile.path, { <span class="hljs-attr">encoding</span>: <span class="hljs-string">&#x27;utf8&#x27;</span> }));
        dom(<span class="hljs-string">&#x27;body &gt; #root&#x27;</span>).addClass(<span class="hljs-string">&#x27;hydrate&#x27;</span>);
        dom(<span class="hljs-string">&#x27;body &gt; #root&#x27;</span>);

        <span class="hljs-comment">// HTML 코드를 저장한다.</span>
        <span class="hljs-keyword">await</span> fs.writeFile(filename, dom.html());
    });
})();</code></pre>
<h3 id="webpack-설정-수정">Webpack 설정 수정</h3>
<p>Webpack 설정 파일에 생성 스크립트로 번들링하는 설정을 추가한다.
Node.js를 타켓팅할 시 일부 모듈은 C/C++ 에드온을 이용할 수 있다. 따라서 해당 경우에 대응할 수 있도록 <a href="https://www.npmjs.com/package/node-loader">node-loader</a> 의존성을 같이 설치한다. (만약 그러한 모듈이 없다면 이 문단에서 <code>.node</code> 관련 내용은 무시해도 된다.) <a href="https://www.npmjs.com/package/empty-loader">empty-loader</a> 모듈은 빌드 스크립트에서 CSS 파일을 무시하는 데 이용된다.</p>
<pre><code class="hljs language-bash">yarn add --dev node-loader empty-loader</code></pre>
<p>그리고 다음과 같이 <code>webpack.config.js</code>를 수정한다.</p>
<pre><code class="hljs language-js"><span class="hljs-comment">// webpack.config.js</span>

<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;path&#x27;</span>);
<span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;html-webpack-plugin&#x27;</span>)
<span class="hljs-keyword">const</span> { CleanWebpackPlugin } = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;clean-webpack-plugin&#x27;</span>);

<span class="hljs-keyword">const</span> dev = process.env.NODE_ENV === <span class="hljs-string">&#x27;development&#x27;</span>;

<span class="hljs-comment">// src/index.tsx 설정과 src/generate.ts 설정에 공통적으로 들어가는 항목들이다.</span>
<span class="hljs-keyword">const</span> commons = {
    <span class="hljs-attr">mode</span>: dev ? <span class="hljs-string">&quot;development&quot;</span> : <span class="hljs-string">&quot;production&quot;</span>,
    <span class="hljs-attr">resolve</span>: {
        <span class="hljs-comment">// .node가 추가되었다.</span>
        <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&#x27;.tsx&#x27;</span>, <span class="hljs-string">&#x27;.ts&#x27;</span>, <span class="hljs-string">&#x27;.js&#x27;</span>, <span class="hljs-string">&#x27;.css&#x27;</span>, <span class="hljs-string">&#x27;.node&#x27;</span>]
    },
    <span class="hljs-attr">module</span>: {
        <span class="hljs-attr">rules</span>: [
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.tsx?$/</span>,
                exclude: <span class="hljs-regexp">/node_modules/</span>,
                use: [
                    {
                        <span class="hljs-attr">loader</span>: <span class="hljs-string">&#x27;babel-loader&#x27;</span>,
                        <span class="hljs-attr">options</span>: {
                            <span class="hljs-attr">presets</span>: [<span class="hljs-string">&#x27;@babel/preset-react&#x27;</span>, <span class="hljs-string">&#x27;@babel/preset-env&#x27;</span>]
                        }
                    },
                    <span class="hljs-string">&#x27;ts-loader&#x27;</span>
                ]
            },
            {
                <span class="hljs-comment">// .node 파일을 로드한다.</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.node$/</span>,
                use: <span class="hljs-string">&#x27;node-loader&#x27;</span>
            }
        ]
    },
    <span class="hljs-attr">plugins</span>: [<span class="hljs-keyword">new</span> CleanWebpackPlugin()]
};

<span class="hljs-built_in">module</span>.exports = [<span class="hljs-comment">/* src/index.tsx 설정 */</span>{
    ...commons,
    <span class="hljs-attr">optimization</span>: {
      <span class="hljs-attr">splitChunks</span>: {
        <span class="hljs-attr">chunks</span>: <span class="hljs-string">&#x27;all&#x27;</span>
      },
      <span class="hljs-attr">minimize</span>: !dev
    },
    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/index.tsx&#x27;</span>,
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>),
        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;[name].js&#x27;</span>
    },
    <span class="hljs-attr">module</span>: {
        ...commons.module,
        <span class="hljs-attr">rules</span>: [
            ...commons.module.rules,
            <span class="hljs-comment">// CSS를 빌드시 로드하도록 하면 오류가 발생한다. (Node.js 환경은 웹브라우저가 아니므로 스타일 주입 시도가 당연히 실패하기 때문이다.)</span>
            <span class="hljs-comment">// 따라서 css파일은 웹브라우저단에서 로드되는 번들 스크립트에서만 주입되도록 </span>
            <span class="hljs-comment">// src/index.tsx Webpack 설정에만 추가한다.</span>
            {
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,
                use: [<span class="hljs-string">&#x27;style-loader&#x27;</span>, <span class="hljs-string">&#x27;css-loader&#x27;</span>, <span class="hljs-string">&#x27;postcss-loader&#x27;</span>]
            },
        ]
    },
    <span class="hljs-attr">plugins</span>: [
        ...commons.plugins,
        <span class="hljs-keyword">new</span> HtmlWebpackPlugin({
        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;index.html&#x27;</span>,
        <span class="hljs-comment">// template 속성을 추가한다.</span>
        <span class="hljs-attr">template</span>: <span class="hljs-string">&#x27;./src/index.html&#x27;</span>
    })],
    <span class="hljs-attr">devServer</span>: {
        <span class="hljs-attr">static</span>: {<span class="hljs-attr">directory</span>: path.join(__dirname, <span class="hljs-string">&#x27;dist&#x27;</span>)},
        <span class="hljs-attr">open</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">port</span>: <span class="hljs-string">&#x27;auto&#x27;</span>,
    },
    <span class="hljs-attr">watchOptions</span>: {
        <span class="hljs-attr">ignored</span>: <span class="hljs-regexp">/node_modules/</span>
    }
}, <span class="hljs-comment">/* src/generate.tsx 설정 */</span> {
    ...commons,
    <span class="hljs-comment">// node로 실행할 스크립트이기 때문에 target을 node로 한다.</span>
    <span class="hljs-attr">target</span>: <span class="hljs-string">&#x27;node&#x27;</span>,
    <span class="hljs-comment">// entry는 src/generate.tsx로 한다.</span>
    <span class="hljs-attr">entry</span>: <span class="hljs-string">&#x27;./src/generate.tsx&#x27;</span>,
    <span class="hljs-attr">module</span>: {
        ...commons.module,
        <span class="hljs-attr">rules</span>: [
            ...commons.module.rules,
            {
                <span class="hljs-comment">// css파일은 무시한다.</span>
                <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,
                use: [<span class="hljs-string">&#x27;empty-loader&#x27;</span>]
            },
        ]
    },
    <span class="hljs-attr">output</span>: {
        <span class="hljs-attr">path</span>: path.resolve(__dirname, <span class="hljs-string">&#x27;dist-builder&#x27;</span>),
        <span class="hljs-attr">filename</span>: <span class="hljs-string">&#x27;index.js&#x27;</span>
    }
}]</code></pre>
<h2 id="빌드-스크립트-실행">빌드 스크립트 실행</h2>
<p>이제 거의 다 됐다. 다음 명령어로 빌드해보자.</p>
<pre><code class="hljs language-bash">npx webpack build
node ./dist-builder</code></pre>
<p>별 다른 오류없이 잘 될 것이다. 축하한다. 이제 앞으로 위 명령어로 빌드하면 초기 HTML 코드가 들어가있는 파일이 빌드될 것이다. 해당 빌드의 결과는 다음과 같다.</p>
<pre><code class="hljs language-html"><span class="hljs-comment">&lt;!-- dist/index.html --&gt;</span>
<span class="hljs-comment">&lt;!-- 참고로 이 예시는 예시일뿐이며, 세부사항은 개개인의 상황에 따라 다를 수 있다. --&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;ko&quot;</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf8&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width,initial-scale=1&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">&quot;X-UA-Compatible&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;IE=edge&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Lorem ipsum<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span>=<span class="hljs-string">&quot;defer&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;166.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">defer</span>=<span class="hljs-string">&quot;defer&quot;</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;main.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;bg-gray-400&quot;</span>&gt;</span>Hello, World!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></code></pre>
</section><div class="Comments_blogComments__GRWmY"></div><nav class="Blog_postNav__ivy8_ Blog_hasBoth__3MRPr"><div class="Blog_leftAnchor__HhzIP"><a href="/post/webpack_and_react_ssg_1"><div class="Blog_postDescription__eV92_"><div class="Blog_title___OFu6">Webpack과 React를 이용한 정적 웹사이트 만들기 (1)</div><div class="Blog_subtitle__RRFh7">Webpack + TypeScript + React + TailwindCSS = TA-DA!</div></div></a></div><div class="Blog_rightAnchor__B9n7B"><a href="/post/rebase_non_consecutive_commits"><div class="Blog_postDescription__eV92_"><div class="Blog_title___OFu6">떨어져 있는 커밋 합치기</div><div class="Blog_subtitle__RRFh7">의외로 간단한 git interactive rebase 활용법</div></div></a></div></nav></div></main><footer class="Layout_footer__bKkxe"><div class="Layout_container__z4qWC"><a href="https://www.gnu.org/licenses/agpl-3.0.en.html"><img alt="GNU Affero General License Version 3" src="https://www.gnu.org/graphics/agplv3-with-text-100x42.png" style="height:31px"/></a> <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"/></a><br/>Copyrights (C) 2020 LiteHell, All rights reserved.<br/><div class="Layout_visibleOnPrintOnly__UK6Yl">LiteHell&#x27;s Blog - <a href="https://blog.litehell.info">https://blog.litehell.info</a><br/>This work is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License.<br/><br/>Url of this article: <a href="https://blog.litehell.info/post/webpack_and_react_ssg_2">https://blog.litehell.info/post/webpack_and_react_ssg_2</a><br/></div><div class="Layout_invisibleOnPrint__rdrDv">Fox Image : Copyrights (C) 2004 Shiretoko-Shari Torurist Association<br/><a href="/license">This blog is free software; For source code and more informations on license and copyrights, Click here.</a><br/><br/>Feeds : <a href="/feed/rss">RSS 2.0</a>,<!-- --> <a href="/feed/atom">Atom 1.0</a>, <a href="/feed/json">Json 1.0</a></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"metadata":{"title":"Webpack과 React를 이용한 정적 웹사이트 만들기 (2)","subtitle":"... + Static HTML Generation = TA-DA!","author":"LiteHell","date":"2023-01-10T05:00:54.358Z","category":"Dev","series":"webpack_and_react_ssg","tags":["React"]},"rendered":"\u003ch1 id=\"들어가는-글\"\u003e들어가는 글\u003c/h1\u003e\n\u003cp\u003e1편에서와 같이 개발하면 매우 잘 된다, 구조가 단순하기 때문이다. 1편의 방식을 개발했을 때 빌드된 결과물을 보면 다음과 같이 생겼을 것이다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-html\"\u003e\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- dist/index.html --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- 참고로 이 예시는 예시일뿐이며, 세부사항은 개개인의 상황에 따라 다를 수 있다. --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e\u0026lt;!doctype \u003cspan class=\"hljs-meta-keyword\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003echarset\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;utf-8\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003eLorem ipsum\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;viewport\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;width=device-width,initial-scale=1\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edefer\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;defer\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;166.js\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edefer\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;defer\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;main.js\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e1편에서 번들링된 파일이 script 태그로 삽입되어 HTML 문서가 불려와진 후 모두 끝난 후 실행되는 형태이다. (\u003ccode\u003edefer\u003c/code\u003e속성은 스크립트가 문서 분석 이후에 실행되도록 한다.)\u003c/p\u003e\n\u003cp\u003e즉, \u003cstrong\u003eCSR(Client-Side Rendering)\u003c/strong\u003e 방식이다. body 태그 내에 div 태그를 만들고 해당 태그에 React Component를 렌더링하는 코드가 클라이언트단에서 모두 실행되는 방식이다. 빌드 단계에서 렌더링이 이루어지지 않으며, 빌드 단계에서 이루어지는 것은 오직 코드 번들링뿐이다.\u003c/p\u003e\n\u003cp\u003e리소스가 한 번만 로드되고 후속 페이지 로드시간이 빠르다는 장점이 있지만 몇가지 단점도 있다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSEO(검색 엔진 최적화)에 불리하다.\u003c/li\u003e\n\u003cli\u003e초기 페이지 로드시간이 느리며, 다 로드되기 전까진 흰 화면만 뜬다. (필요한 JavaScript와 CSS를 다 불러와야 하기 때문이다.)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이러한 단점들을 극복하려면 어떻게 해야할까?\u003c/p\u003e\n\u003ch2 id=\"with-react-hydration\"\u003ewith React Hydration\u003c/h2\u003e\n\u003cp\u003e빌드시에 초기 HTML을 생성하고, 진입 스크립트을 hydration을 하는 방식으로 수정하면 된다. 여기서 hydration이란 ReactDOMServer에 의해 렌더링된 초기 마크업 코드에 이벤트 리스너를 연결(즉, 요약하자면 재활용)하는 것이다.\u003c/p\u003e\n\u003cp\u003e이 방식을 이용하면 HTML 마크업 코드는 빌드 단계에서 생성되고, 클라이언트단에서는 React가 이미 생성된 HTML 코드에 부착(attach)하여 동작한다. 이 방식의 장점은 다음과 같다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eSEO(검색 엔진 최적화)에 유리하다.\u003c/li\u003e\n\u003cli\u003eJavaScript와 CSS가 다 불려와지기 전까지 흰화면만 뜨는 현상을 수정할 수 있다.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e이 방식을 채택하기 전에 먼지 어떤 사항을 확인해야 하는지 한 번 알아보자.\u003c/p\u003e\n\u003ch3 id=\"유효한-html코드-작성\"\u003e유효한 HTML코드 작성\u003c/h3\u003e\n\u003cp\u003e모든 HTML 코드는 유효하게 작성되어야 한다. 예시를 들자면, p태그 안에는 p태그가 들어갈 수 없다.\u003c/p\u003e\n\u003cp\u003eReact hydration을 하기 위해서는, 빌드단에서 생성된 HTML 코드와 React Component가 생성하는 UI 코드가 일치해야 한다. 만약 초기 UI 불일치 오류가 나타난다면, 유효하지 않은 HTML 코드를 작성한 건 아닌지 한 번 확인해봐야 한다.\u003c/p\u003e\n\u003ch3 id=\"클라이언트단에서만-작동하는-코드-수정\"\u003e클라이언트단에서만 작동하는 코드 수정\u003c/h3\u003e\n\u003cp\u003eNode.js 환경에서 실행되면 오류가 나는 코드가 있다. 이런 코드들은 브라우저 환경에서만 실행되도록 수정해야 한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-comment\"\u003e// 예시\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e isBrowser = \u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etypeof\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ewindow\u003c/span\u003e !== \u003cspan class=\"hljs-string\"\u003e\u0026#x27;undefined\u0026#x27;\u003c/span\u003e \u0026amp;\u0026amp; \u003cspan class=\"hljs-keyword\"\u003etypeof\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e !== \u003cspan class=\"hljs-string\"\u003e\u0026#x27;undefined\u0026#x27;\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isBrowser())\n    \u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;../some_module_that_works_only_on_browser\u0026#x27;\u003c/span\u003e);\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e또한, 브라우저단에서 결과가 결정되거나 항상 일정하지 않은 코드는 \u003ccode\u003euseEffect\u003c/code\u003e 등을 이용해 UI가 렌더링된 이후에 실행되도록 수정해야 한다. \n\u003ccode\u003euseState\u003c/code\u003e와 \u003ccode\u003euseEffect\u003c/code\u003e 등은 브라우저단에서만 렌더링된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { useState, useEffect } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment\"\u003e// 예시\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eAreYouKorean\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-comment\"\u003e// const isKorean = navigator.language === \u0026#x27;ko\u0026#x27;;\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e [isKorean, setIsKorean] = useState\u0026lt;\u003cspan class=\"hljs-built_in\"\u003eboolean\u003c/span\u003e | \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e\u0026gt;(\u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e);\n    useEffect(\u003cspan class=\"hljs-function\"\u003e() =\u0026gt;\u003c/span\u003e {\n        setIsKorean(navigator.language === \u003cspan class=\"hljs-string\"\u003e\u0026#x27;ko\u0026#x27;\u003c/span\u003e);\n    });\n\n    \u003cspan class=\"hljs-keyword\"\u003elet\u003c/span\u003e message: \u003cspan class=\"hljs-built_in\"\u003estring\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;...\u0026#x27;\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isKorean !== \u003cspan class=\"hljs-literal\"\u003enull\u003c/span\u003e)\n        message = isKorean ? \u003cspan class=\"hljs-string\"\u003e\u0026#x27;한국인이시군요.\u0026#x27;\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\u0026quot;You\u0026#x27;re not Korean!\u0026quot;\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e{ message }\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"결과가-불명확한-코드-수정\"\u003e결과가 불명확한 코드 수정\u003c/h3\u003e\n\u003cp\u003e이런 코드는 당연히 빌드할 때 생긴 초기 UI와 클라이언트 렌더링시의 초기 UI가 서로 다르게 한다. 빌드시 시간의 초 단위가 짝수면 결과는 *Yes!*가 렌더링될텐데, 사용자가 로드할 때 시간이 홀수면 *No!*가 렌더링되니 서로 불일치하다. 이런 코드가 있다면 수정해야 한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eisTimeEven\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e time = (\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eDate\u003c/span\u003e()).getSeconds() % \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e === \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e;\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e time ? \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e Yes! \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e : \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e No! \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ep\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"hydration-적용\"\u003ehydration 적용\u003c/h2\u003e\n\u003cp\u003e위에서 언급한 문제를 모두 수정했다면 hydration시 초기 UI 불일치 오류는 없을 것이다. 이제 hydration을 적용해보자.\u003c/p\u003e\n\u003ch3 id=\"진입-스크립트-수정\"\u003e진입 스크립트 수정\u003c/h3\u003e\n\u003cp\u003e먼저, hydrate하도록 \u003ccode\u003esrc/index.tsx\u003c/code\u003e를 수정하자.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-comment\"\u003e// src/index.tsx\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e React \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e ReactDOM \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;react-dom/client\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;../styles/index.css\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e isBrowser \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./isBrowser\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eIndex\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;bg-gray-400\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      Hello, World!\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-comment\"\u003e// 만약 브라우저라면\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (isBrowser()) {\n    \u003cspan class=\"hljs-comment\"\u003e// body \u0026gt; #root 태그에\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e rootDiv = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.querySelector(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;body \u0026gt; #root\u0026#x27;\u003c/span\u003e)!;\n    \u003cspan class=\"hljs-comment\"\u003e// hydration이 필요하다면 (빌드 결과물)\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003eif\u003c/span\u003e (rootDiv.classList.contains(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;hydrate\u0026#x27;\u003c/span\u003e)) {\n        \u003cspan class=\"hljs-comment\"\u003e// Index 컴포넌트를 hydrate한다.\u003c/span\u003e\n        ReactDOM.hydrateRoot(rootDiv, \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eIndex\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e);\n    } \u003cspan class=\"hljs-keyword\"\u003eelse\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e/* 만약 hydration이 필요없다면 (webpack serve) */\u003c/span\u003e {\n        \u003cspan class=\"hljs-comment\"\u003e// 그냥 렌더링 한다.\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e root = ReactDOM.createRoot(rootDiv);\n        root.render(\u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eIndex\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e)\n    }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e브라우저 환경 여부를 판단하는 \u003ccode\u003esrc/isBrowser.ts\u003c/code\u003e도 간단하게 작성한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-comment\"\u003e// src/isBrowser.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003edefault\u003c/span\u003e \u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eisBrowser\u003c/span\u003e (\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003etypeof\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ewindow\u003c/span\u003e !== \u003cspan class=\"hljs-string\"\u003e\u0026#x27;undefined\u0026#x27;\u003c/span\u003e \u0026amp;\u0026amp; \u003cspan class=\"hljs-keyword\"\u003etypeof\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e !== \u003cspan class=\"hljs-string\"\u003e\u0026#x27;undefined\u0026#x27;\u003c/span\u003e;\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003esrc/index.tsx\u003c/code\u003e는 빌드 스크립트에서도 import된다. 따라서 브라우저단에서만 실행되야 하는 코드는 브라우저단에서만 실행되도록 수정해야 한다.\u003c/p\u003e\n\u003ch3 id=\"html-템플릿-생성\"\u003eHTML 템플릿 생성\u003c/h3\u003e\n\u003cp\u003e그 다음으로, 간단한 HTML 템플릿을 생성한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-html\"\u003e\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- src/index.html --\u0026gt;\u003c/span\u003e\n\n\u003cspan class=\"hljs-meta\"\u003e\u0026lt;!DOCTYPE \u003cspan class=\"hljs-meta-keyword\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003elang\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;ko\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003echarset\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;utf8\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;viewport\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;width=device-width, initial-scale=1\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehttp-equiv\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;X-UA-Compatible\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;IE=edge\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003eLorem ipsum\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;root\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"html-생성-스크립트-추가\"\u003eHTML 생성 스크립트 추가\u003c/h3\u003e\n\u003cp\u003e초기 HTML 코드를 생성하는 스크립트를 작성해야 한다. 먼저 스크립트 작성 전에 의존성을 몇가지 설치하자.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eyarn add cheerio tmp-promise\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그 다음으로, 다음과 같이 스크립트를 작성한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-comment\"\u003e// src/generate.tsx\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { load \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e loadHTML } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;cheerio\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e { createWriteStream, promises \u003cspan class=\"hljs-keyword\"\u003eas\u003c/span\u003e fs } \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;fs\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e React \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e server \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;react-dom/server\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e tmp \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;tmp-promise\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e Index \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./index\u0026#x27;\u003c/span\u003e;\n\n(\u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e () =\u0026gt; {\n    \u003cspan class=\"hljs-comment\"\u003e// 임시 파일을 생성한다.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e tmpFile = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e tmp.file();\n\n    \u003cspan class=\"hljs-comment\"\u003e// Webpack 번들러에 의해 생성된 HTML 파일의 위치이다.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e filename = \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./dist/index.html\u0026#x27;\u003c/span\u003e;\n\n    \u003cspan class=\"hljs-comment\"\u003e// 초기 UI 코드를 생성하는 ReactDOMServer의 스트림이다.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e reactStream = server.renderToPipeableStream(\u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eIndex\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-comment\"\u003e// 스트림을 임시 파일에 쓴다.\u003c/span\u003e\n    \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e fileStream = createWriteStream(tmpFile.path);\n\n    \u003cspan class=\"hljs-comment\"\u003e// 초기 UI 코드가 임시 파일에 모두 써졌으면\u003c/span\u003e\n    reactStream.pipe(fileStream).on(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;finish\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e () =\u0026gt; {\n        \u003cspan class=\"hljs-comment\"\u003e// 웹팩에 의해 번들링된 HTML 파일을 읽는다.\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e htmlText = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e fs.readFile(filename, { \u003cspan class=\"hljs-attr\"\u003eencoding\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;utf8\u0026#x27;\u003c/span\u003e });\n\n        \u003cspan class=\"hljs-comment\"\u003e// HTML 파일의 id가 root인 태그에 초기 UI 코드를 넣는다.\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e dom = loadHTML(htmlText);\n        dom(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;body \u0026gt; #root\u0026#x27;\u003c/span\u003e).html(\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e fs.readFile(tmpFile.path, { \u003cspan class=\"hljs-attr\"\u003eencoding\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;utf8\u0026#x27;\u003c/span\u003e }));\n        dom(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;body \u0026gt; #root\u0026#x27;\u003c/span\u003e).addClass(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;hydrate\u0026#x27;\u003c/span\u003e);\n        dom(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;body \u0026gt; #root\u0026#x27;\u003c/span\u003e);\n\n        \u003cspan class=\"hljs-comment\"\u003e// HTML 코드를 저장한다.\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e fs.writeFile(filename, dom.html());\n    });\n})();\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"webpack-설정-수정\"\u003eWebpack 설정 수정\u003c/h3\u003e\n\u003cp\u003eWebpack 설정 파일에 생성 스크립트로 번들링하는 설정을 추가한다.\nNode.js를 타켓팅할 시 일부 모듈은 C/C++ 에드온을 이용할 수 있다. 따라서 해당 경우에 대응할 수 있도록 \u003ca href=\"https://www.npmjs.com/package/node-loader\"\u003enode-loader\u003c/a\u003e 의존성을 같이 설치한다. (만약 그러한 모듈이 없다면 이 문단에서 \u003ccode\u003e.node\u003c/code\u003e 관련 내용은 무시해도 된다.) \u003ca href=\"https://www.npmjs.com/package/empty-loader\"\u003eempty-loader\u003c/a\u003e 모듈은 빌드 스크립트에서 CSS 파일을 무시하는 데 이용된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eyarn add --dev node-loader empty-loader\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그리고 다음과 같이 \u003ccode\u003ewebpack.config.js\u003c/code\u003e를 수정한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// webpack.config.js\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e path = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;path\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e HtmlWebpackPlugin = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;html-webpack-plugin\u0026#x27;\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { CleanWebpackPlugin } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;clean-webpack-plugin\u0026#x27;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e dev = process.env.NODE_ENV === \u003cspan class=\"hljs-string\"\u003e\u0026#x27;development\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-comment\"\u003e// src/index.tsx 설정과 src/generate.ts 설정에 공통적으로 들어가는 항목들이다.\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e commons = {\n    \u003cspan class=\"hljs-attr\"\u003emode\u003c/span\u003e: dev ? \u003cspan class=\"hljs-string\"\u003e\u0026quot;development\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\u0026quot;production\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eresolve\u003c/span\u003e: {\n        \u003cspan class=\"hljs-comment\"\u003e// .node가 추가되었다.\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003eextensions\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.tsx\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.ts\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.js\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.css\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.node\u0026#x27;\u003c/span\u003e]\n    },\n    \u003cspan class=\"hljs-attr\"\u003emodule\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003erules\u003c/span\u003e: [\n            {\n                \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\.tsx?$/\u003c/span\u003e,\n                exclude: \u003cspan class=\"hljs-regexp\"\u003e/node_modules/\u003c/span\u003e,\n                use: [\n                    {\n                        \u003cspan class=\"hljs-attr\"\u003eloader\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;babel-loader\u0026#x27;\u003c/span\u003e,\n                        \u003cspan class=\"hljs-attr\"\u003eoptions\u003c/span\u003e: {\n                            \u003cspan class=\"hljs-attr\"\u003epresets\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;@babel/preset-react\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;@babel/preset-env\u0026#x27;\u003c/span\u003e]\n                        }\n                    },\n                    \u003cspan class=\"hljs-string\"\u003e\u0026#x27;ts-loader\u0026#x27;\u003c/span\u003e\n                ]\n            },\n            {\n                \u003cspan class=\"hljs-comment\"\u003e// .node 파일을 로드한다.\u003c/span\u003e\n                \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\.node$/\u003c/span\u003e,\n                use: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;node-loader\u0026#x27;\u003c/span\u003e\n            }\n        ]\n    },\n    \u003cspan class=\"hljs-attr\"\u003eplugins\u003c/span\u003e: [\u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e CleanWebpackPlugin()]\n};\n\n\u003cspan class=\"hljs-built_in\"\u003emodule\u003c/span\u003e.exports = [\u003cspan class=\"hljs-comment\"\u003e/* src/index.tsx 설정 */\u003c/span\u003e{\n    ...commons,\n    \u003cspan class=\"hljs-attr\"\u003eoptimization\u003c/span\u003e: {\n      \u003cspan class=\"hljs-attr\"\u003esplitChunks\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003echunks\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;all\u0026#x27;\u003c/span\u003e\n      },\n      \u003cspan class=\"hljs-attr\"\u003eminimize\u003c/span\u003e: !dev\n    },\n    \u003cspan class=\"hljs-attr\"\u003eentry\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./src/index.tsx\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eoutput\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: path.resolve(__dirname, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;dist\u0026#x27;\u003c/span\u003e),\n        \u003cspan class=\"hljs-attr\"\u003efilename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;[name].js\u0026#x27;\u003c/span\u003e\n    },\n    \u003cspan class=\"hljs-attr\"\u003emodule\u003c/span\u003e: {\n        ...commons.module,\n        \u003cspan class=\"hljs-attr\"\u003erules\u003c/span\u003e: [\n            ...commons.module.rules,\n            \u003cspan class=\"hljs-comment\"\u003e// CSS를 빌드시 로드하도록 하면 오류가 발생한다. (Node.js 환경은 웹브라우저가 아니므로 스타일 주입 시도가 당연히 실패하기 때문이다.)\u003c/span\u003e\n            \u003cspan class=\"hljs-comment\"\u003e// 따라서 css파일은 웹브라우저단에서 로드되는 번들 스크립트에서만 주입되도록 \u003c/span\u003e\n            \u003cspan class=\"hljs-comment\"\u003e// src/index.tsx Webpack 설정에만 추가한다.\u003c/span\u003e\n            {\n                \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\.css$/\u003c/span\u003e,\n                use: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;style-loader\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;css-loader\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;postcss-loader\u0026#x27;\u003c/span\u003e]\n            },\n        ]\n    },\n    \u003cspan class=\"hljs-attr\"\u003eplugins\u003c/span\u003e: [\n        ...commons.plugins,\n        \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HtmlWebpackPlugin({\n        \u003cspan class=\"hljs-attr\"\u003efilename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;index.html\u0026#x27;\u003c/span\u003e,\n        \u003cspan class=\"hljs-comment\"\u003e// template 속성을 추가한다.\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003etemplate\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./src/index.html\u0026#x27;\u003c/span\u003e\n    })],\n    \u003cspan class=\"hljs-attr\"\u003edevServer\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003estatic\u003c/span\u003e: {\u003cspan class=\"hljs-attr\"\u003edirectory\u003c/span\u003e: path.join(__dirname, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;dist\u0026#x27;\u003c/span\u003e)},\n        \u003cspan class=\"hljs-attr\"\u003eopen\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eport\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;auto\u0026#x27;\u003c/span\u003e,\n    },\n    \u003cspan class=\"hljs-attr\"\u003ewatchOptions\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003eignored\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/node_modules/\u003c/span\u003e\n    }\n}, \u003cspan class=\"hljs-comment\"\u003e/* src/generate.tsx 설정 */\u003c/span\u003e {\n    ...commons,\n    \u003cspan class=\"hljs-comment\"\u003e// node로 실행할 스크립트이기 때문에 target을 node로 한다.\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003etarget\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;node\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-comment\"\u003e// entry는 src/generate.tsx로 한다.\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eentry\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./src/generate.tsx\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003emodule\u003c/span\u003e: {\n        ...commons.module,\n        \u003cspan class=\"hljs-attr\"\u003erules\u003c/span\u003e: [\n            ...commons.module.rules,\n            {\n                \u003cspan class=\"hljs-comment\"\u003e// css파일은 무시한다.\u003c/span\u003e\n                \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\.css$/\u003c/span\u003e,\n                use: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;empty-loader\u0026#x27;\u003c/span\u003e]\n            },\n        ]\n    },\n    \u003cspan class=\"hljs-attr\"\u003eoutput\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: path.resolve(__dirname, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;dist-builder\u0026#x27;\u003c/span\u003e),\n        \u003cspan class=\"hljs-attr\"\u003efilename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;index.js\u0026#x27;\u003c/span\u003e\n    }\n}]\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"빌드-스크립트-실행\"\u003e빌드 스크립트 실행\u003c/h2\u003e\n\u003cp\u003e이제 거의 다 됐다. 다음 명령어로 빌드해보자.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpx webpack build\nnode ./dist-builder\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e별 다른 오류없이 잘 될 것이다. 축하한다. 이제 앞으로 위 명령어로 빌드하면 초기 HTML 코드가 들어가있는 파일이 빌드될 것이다. 해당 빌드의 결과는 다음과 같다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-html\"\u003e\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- dist/index.html --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e\u0026lt;!-- 참고로 이 예시는 예시일뿐이며, 세부사항은 개개인의 상황에 따라 다를 수 있다. --\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-meta\"\u003e\u0026lt;!DOCTYPE \u003cspan class=\"hljs-meta-keyword\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003elang\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;ko\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003echarset\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;utf8\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;viewport\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;width=device-width,initial-scale=1\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003emeta\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003ehttp-equiv\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;X-UA-Compatible\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;IE=edge\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003eLorem ipsum\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003etitle\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edefer\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;defer\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;166.js\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003edefer\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;defer\u0026quot;\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003esrc\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;main.js\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003escript\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehead\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;root\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n            \u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclass\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;bg-gray-400\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003eHello, World!\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n        \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ebody\u003c/span\u003e\u0026gt;\u003c/span\u003e\n\u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ehtml\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n"},"articleId":"webpack_and_react_ssg_2","series":[{"title":"Webpack과 React를 이용한 정적 웹사이트 만들기 (1)","articleId":"webpack_and_react_ssg_1"},{"title":"Webpack과 React를 이용한 정적 웹사이트 만들기 (2)","articleId":"webpack_and_react_ssg_2"},{"title":"Webpack과 React를 이용한 정적 웹사이트 만들기 (3)","articleId":"webpack_and_react_ssg_3"}],"seriesName":"Webpack과 React를 이용한 정적 웹사이트 만들기","previousPost":{"name":"webpack_and_react_ssg_1","metadata":{"title":"Webpack과 React를 이용한 정적 웹사이트 만들기 (1)","subtitle":"Webpack + TypeScript + React + TailwindCSS = TA-DA!","author":"LiteHell","date":"2023-01-10T05:00:48.244Z","series":"webpack_and_react_ssg","seriesName":"Webpack과 React를 이용한 정적 웹사이트 만들기","category":"Dev","tags":["React"]},"rendered":"\u003ch1 id=\"들어가는-글\"\u003e들어가는 글\u003c/h1\u003e\n\u003cp\u003e본래 \u003ca href=\"https://litehell.info\"\u003e내 개인 웹사이트\u003c/a\u003e는 \u003ca href=\"https://nextjs.org/docs/advanced-features/static-html-export\"\u003eNext.js의 Static HTML Export 기능\u003c/a\u003e과 \u003ca href=\"https://pages.github.com/\"\u003eGitHub Pages\u003c/a\u003e를 이용해 배포됐다. 디자인에는 \u003ca href=\"https://bulma.io\"\u003ebulma CSS 프레임워크\u003c/a\u003e를 이용했다.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/homepage_before_redesign_2022.png\" alt=\"홈페이지 재디자인 전의 이미지\"\u003e\u003c/p\u003e\n\u003cp\u003e위와 같이 bulma에서 제공하는 component들을 이용해 간단하게 디자인했다.\u003c/p\u003e\n\u003cp\u003e그러나 내 웹사이트를 몇 번 보다보니 디자인을 좀 설렁설렁하게 한 느낌이 들었다. 그래서 디자인을 한 번 바꿔보고 싶었고, 이번 기회에 Next.js를 쓰지 않고 직접 정적 파일로 배포하는 경험도 해보고 싶었다.\u003c/p\u003e\n\u003cp\u003e이 글은 개인 홈페이지를 재작성한 경험에 기반하여 쓰는 글이지만, 독자들이 따라하며 참고할 수 있도록 일부 변형하여 작성했다. 설명을 최대한 자세하게 하려 노력했지만, 글 쓰는 실력이 좋은 편이 아니라 읽기 불편할 수 있으니 양해해주셨으면 좋겠다.\u003c/p\u003e\n\u003ch1 id=\"webpack과-babel-그리고-typescript\"\u003eWebpack과 Babel, 그리고 Typescript\u003c/h1\u003e\n\u003cp\u003eNext.js는 쓰지 않았다. 간단한 한 페이지 정적 페이지 만드는 데에는 Webpack이면 충분하다.\u003c/p\u003e\n\u003cp\u003e이제 어떤 기술스택을 쓸 지 정했다, 이제 필요한 의존성을 먼저 설치하면 된다. 의존성을 한 번 설치해보자.\u003c/p\u003e\n\u003ch2 id=\"의존성-설치하기\"\u003e의존성 설치하기\u003c/h2\u003e\n\u003cp\u003e먼저 React와 Typescript를 설치한다. 재디자인 전에 했듯이 이번에도 React로 개발할 것이다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eyarn add react-dom react\nyarn add --dev typescript react @types/react @types/react-dom\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그 다음, 다음 명령어로 tsconfig.json을 생성한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpx tsc --init\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e생성된 tsconfig.json에서 \u003ccode\u003ejsx\u003c/code\u003e 속성을 \u003ccode\u003ereact\u003c/code\u003e로(다르게 해도 되긴 한데 나는 이렇게 했다), 그리고 \u003ccode\u003emoduleResolution\u003c/code\u003e 속성은 \u003ccode\u003enode\u003c/code\u003e로 바꾸어야 한다. 이 외에 나머지 속성들은 개인 취향대로 하면 된다. 일단 개인 취향대로 하고 나중에 코딩하다 \u003ccode\u003etsconfig.json\u003c/code\u003e때문에 오류나면 그때 수정하면 된다.\u003c/p\u003e\n\u003cp\u003e참고로 내 \u003ccode\u003etsconfig.json\u003c/code\u003e는 다음과 같다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-json\"\u003e{\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;compilerOptions\u0026quot;\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;target\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;es2016\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;lib\u0026quot;\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026quot;DOM\u0026quot;\u003c/span\u003e],\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;jsx\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;module\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;ESNext\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;moduleResolution\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;node\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;typeRoots\u0026quot;\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026quot;node_modules/@types\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;src/types\u0026quot;\u003c/span\u003e],\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;allowJs\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;checkJs\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;allowSyntheticDefaultImports\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;forceConsistentCasingInFileNames\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;strict\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;noImplicitAny\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;strictNullChecks\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;strictFunctionTypes\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;alwaysStrict\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;noUnusedLocals\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;noUnusedParameters\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003e\u0026quot;skipLibCheck\u0026quot;\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e\n  },\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;include\u0026quot;\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026quot;src/**/*.tsx\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;src/**/*.ts\u0026quot;\u003c/span\u003e],\n  \u003cspan class=\"hljs-attr\"\u003e\u0026quot;exclude\u0026quot;\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026quot;node_modules\u0026quot;\u003c/span\u003e]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e그 다음으로는 Webpack이 필요하다. 다음 명령어로 Webpack을 추가하자.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eyarn add webpack webpack-cli\nyarn add --dev webpack-dev-server ts-loader style-loader clean-webpack-plugin css-loader html-webpack-plugin\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e각 패키지들의 설명은 다음과 같다.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ewebpack\u003c/code\u003e, \u003ccode\u003ewebpack-cli\u003c/code\u003e : Webpack이다. 설명이 필요없다.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ewebpack-dev-server\u003c/code\u003e : 수정이 되면 자동으로 webpack 재빌드해서 새로고침되는 웹 서버를 열기 위해 이용한다. 디버깅이 편해진다.\u003c/li\u003e\n\u003cli\u003ewebpack loader: Webpack에서 특정 유형의 파일을 불러오거나 변형한다.\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ets-loader\u003c/code\u003e: \u003ccode\u003e.ts\u003c/code\u003e나 \u003ccode\u003e.tsx\u003c/code\u003e파일을 Webpack에서 읽을 때 쓴다.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ecss-loader\u003c/code\u003e: css 파일에서 \u003ccode\u003e@import\u003c/code\u003e나 \u003ccode\u003eurl()\u003c/code\u003e 구절들을 \u003ccode\u003eimport/require()\u003c/code\u003e와 같은 식으로 해석하는 loader다.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003estyle-loader\u003c/code\u003e: css를 웹페이지에 추가하는 loader다\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003ewebpack plugin\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eclean-webpack-plugin\u003c/code\u003e: 출력 디렉토리내 파일들을 삭제하는 플러그인이다.\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehtml-webpack-plugin\u003c/code\u003e: 생성된 js 파일의 스크립트 태그들이 추가된 html파일을 자동으로 생성한다\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e나는 이번에 babel을 쓸 것이다. babel은 최신 버전의 자바스크립트 기능을 브라우저 지원에 신경쓰지 않고 쓸 수 있게 해준다. 아래 명령어로 babel도 설치하자.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eyarn add --dev @babel/core @babel/preset-env @babel/preset-react babel-loader\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"https://tailwindcss.com/\"\u003eTailwindCSS\u003c/a\u003e가 웹사이트 빠르게 만드는 데 좋다갈래 반신반의하는 느낌으로 한 번 써보려 한다. TailwindCSS를 쓰려면 다음 패키지들을 설치해야 한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003eyarn add --dev autoprefixer postcss postcss-loader tailwindcss\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"webpack-설정하기\"\u003eWebpack 설정하기\u003c/h2\u003e\n\u003cp\u003e이제 Webpack을 설정해야 한다. 루트 디렉토리에 \u003ccode\u003ewebpack.config.js\u003c/code\u003e를 생성하고 내용을 다음과 같이 한다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// webpack.config.js\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e path = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;path\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e HtmlWebpackPlugin = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;html-webpack-plugin\u0026#x27;\u003c/span\u003e)\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e { CleanWebpackPlugin } = \u003cspan class=\"hljs-built_in\"\u003erequire\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;clean-webpack-plugin\u0026#x27;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e dev = process.env.NODE_ENV === \u003cspan class=\"hljs-string\"\u003e\u0026#x27;development\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-built_in\"\u003emodule\u003c/span\u003e.exports = {\n    \u003cspan class=\"hljs-comment\"\u003e// 개발시라면 개발 모드로 한다.\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003emode\u003c/span\u003e: dev ? \u003cspan class=\"hljs-string\"\u003e\u0026quot;development\u0026quot;\u003c/span\u003e : \u003cspan class=\"hljs-string\"\u003e\u0026quot;production\u0026quot;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eoptimization\u003c/span\u003e: {\n      \u003cspan class=\"hljs-attr\"\u003esplitChunks\u003c/span\u003e: {\n        \u003cspan class=\"hljs-comment\"\u003e// 청크를 가능한만큼 다 분리한다.\u003c/span\u003e\n        \u003cspan class=\"hljs-comment\"\u003e// 파일 각각의 용량을 줄여들어서 웹페이지 로드속도 감소에 도움이 된다.\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003echunks\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;all\u0026#x27;\u003c/span\u003e\n      },\n      \u003cspan class=\"hljs-comment\"\u003e// 개발중이 아니라면 압축한다.\u003c/span\u003e\n      \u003cspan class=\"hljs-attr\"\u003eminimize\u003c/span\u003e: !dev\n    },\n    \u003cspan class=\"hljs-comment\"\u003e// 진입 파일이다.\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// ./src/index.tsx 파일에 필요한 모듈들을 번들링한다고 이해하면 된다.\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e//\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// 즉, 다시 말해 출력파일을 실행하면 ./src/index.tsx을 실행하는 것과 동일한 효과를 가진다,\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// 다만 필요한 모듈들이 같이 번들링되어 있어 웹 환경 등에서도 실행이 용이할 뿐이다.\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003eentry\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;./src/index.tsx\u0026#x27;\u003c/span\u003e,\n    \u003cspan class=\"hljs-attr\"\u003eoutput\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003epath\u003c/span\u003e: path.resolve(__dirname, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;dist\u0026#x27;\u003c/span\u003e),\n        \u003cspan class=\"hljs-comment\"\u003e// index.js로 하면 splitChunks 속성때문에 오류가 난다.\u003c/span\u003e\n        \u003cspan class=\"hljs-attr\"\u003efilename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;[name].js\u0026#x27;\u003c/span\u003e\n    },\n    \u003cspan class=\"hljs-attr\"\u003eresolve\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003eextensions\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;.tsx\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.ts\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.js\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;.css\u0026#x27;\u003c/span\u003e]\n    },\n    \u003cspan class=\"hljs-attr\"\u003emodule\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003erules\u003c/span\u003e: [\n            \u003cspan class=\"hljs-comment\"\u003e// 참고: use 속성은 마지막 아이템에서 첫 아이템으로의 순서, 즉 다시 말해 오른쪽에서 왼쪽으로의 순서로 해석된다.\u003c/span\u003e\n            {\n                \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\.tsx?$/\u003c/span\u003e,\n                exclude: \u003cspan class=\"hljs-regexp\"\u003e/node_modules/\u003c/span\u003e,\n                use: [\n                    \u003cspan class=\"hljs-comment\"\u003e// Babel은 현대 자바스크립트를 브라우저 지원여부을 고려할 필요없이 쓸 수 있도록 해준다.\u003c/span\u003e\n                    {\n                        \u003cspan class=\"hljs-attr\"\u003eloader\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;babel-loader\u0026#x27;\u003c/span\u003e,\n                        \u003cspan class=\"hljs-attr\"\u003eoptions\u003c/span\u003e: {\n                            \u003cspan class=\"hljs-attr\"\u003epresets\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;@babel/preset-react\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;@babel/preset-env\u0026#x27;\u003c/span\u003e]\n                        }\n                    },\n                    \u003cspan class=\"hljs-comment\"\u003e// Typescript를 Javascript로 컴파일해준다.\u003c/span\u003e\n                    \u003cspan class=\"hljs-string\"\u003e\u0026#x27;ts-loader\u0026#x27;\u003c/span\u003e\n                ]\n            },\n            {\n                \u003cspan class=\"hljs-attr\"\u003etest\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/\\.css$/\u003c/span\u003e,\n                \u003cspan class=\"hljs-comment\"\u003e// postcss-loader는 TailwindCSS 적용에 이용된다.\u003c/span\u003e\n                use: [\u003cspan class=\"hljs-string\"\u003e\u0026#x27;style-loader\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;css-loader\u0026#x27;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;postcss-loader\u0026#x27;\u003c/span\u003e]\n            }\n        ]\n    },\n    \u003cspan class=\"hljs-attr\"\u003eplugins\u003c/span\u003e: [\n        \u003cspan class=\"hljs-comment\"\u003e// 빌드전에 dist 디렉토리내 파일들을 먼저 지우고 \u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e CleanWebpackPlugin(),\n        \u003cspan class=\"hljs-comment\"\u003e// 빌드후 출력파일들이 script태그로 포함된 html파일을 생성한다.\u003c/span\u003e\n        \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e HtmlWebpackPlugin({\n        \u003cspan class=\"hljs-attr\"\u003etitle\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;Yeonjin Shin\u0026#x27;\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003efilename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;index.html\u0026#x27;\u003c/span\u003e\n    })],\n    \u003cspan class=\"hljs-comment\"\u003e// 디버깅할 때 쓰는 웹서버에 관한 설정이다.\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// webpack serve로 열 수 있다.\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003edevServer\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003estatic\u003c/span\u003e: {\u003cspan class=\"hljs-attr\"\u003edirectory\u003c/span\u003e: path.join(__dirname, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;dist\u0026#x27;\u003c/span\u003e)},\n        \u003cspan class=\"hljs-attr\"\u003eopen\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n        \u003cspan class=\"hljs-attr\"\u003eport\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026#x27;auto\u0026#x27;\u003c/span\u003e,\n    },\n    \u003cspan class=\"hljs-comment\"\u003e// 이거 안하면 node_modules내 수 많은 파일의 변경여부도 같이 확인하기 때문에\u003c/span\u003e\n    \u003cspan class=\"hljs-comment\"\u003e// 디버깅용 웹서버가 정상적으로 작동하지 않는다.\u003c/span\u003e\n    \u003cspan class=\"hljs-attr\"\u003ewatchOptions\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003eignored\u003c/span\u003e: \u003cspan class=\"hljs-regexp\"\u003e/node_modules/\u003c/span\u003e\n    }\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"tailwindcss-설정하기\"\u003eTailwindCSS 설정하기\u003c/h2\u003e\n\u003cp\u003eTailwindCSS를 적용하려면 TailwindCSS 설정파일을 생성해야 한다. TailwindCSS 설정 파일은 다음 명령어로 생성할 수 있다. \u003ccode\u003e-p\u003c/code\u003e 매개변수를 주면 PostCSS 설정파일도 같이 생성해준다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003enpx tailwindcss init -p\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ccode\u003epostcss.config.js\u003c/code\u003e는 생성된 그대로 쓰면 되고, \u003ccode\u003etailwind.config.js\u003c/code\u003e만 수정하면 된다. \u003ccode\u003etailwind.config.js\u003c/code\u003e에 \u003ccode\u003econtent\u003c/code\u003e 속성에 TailwindCSS를 사용할 파일 패턴을 넣는다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-js\"\u003e\u003cspan class=\"hljs-comment\"\u003e// tailwind.config.js\u003c/span\u003e\n\u003cspan class=\"hljs-comment\"\u003e/** \u003cspan class=\"hljs-doctag\"\u003e@type \u003cspan class=\"hljs-type\"\u003e{import(\u0026#x27;tailwindcss\u0026#x27;).Config}\u003c/span\u003e \u003c/span\u003e*/\u003c/span\u003e\n\u003cspan class=\"hljs-built_in\"\u003emodule\u003c/span\u003e.exports = {\n  \u003cspan class=\"hljs-attr\"\u003econtent\u003c/span\u003e: [\u003cspan class=\"hljs-string\"\u003e\u0026quot;./src/**/*.{js,css,ts,tsx}\u0026quot;\u003c/span\u003e],\n  \u003cspan class=\"hljs-attr\"\u003etheme\u003c/span\u003e: {\n    \u003cspan class=\"hljs-attr\"\u003eextend\u003c/span\u003e: {},\n  },\n  \u003cspan class=\"hljs-attr\"\u003eplugins\u003c/span\u003e: [],\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이제 TailwindCSS를 쓰기 위해 한 가지만 더 하면 된다. 다음과 같이 \u003ccode\u003e@tailwind\u003c/code\u003e 구문들이 들어간 css파일을 생성하고, 그 css 파일을 프론트엔드 코드에서 추가해주면 된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-css\"\u003e\u003cspan class=\"hljs-comment\"\u003e/* styles/index.css */\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003e@tailwind\u003c/span\u003e base;\n\u003cspan class=\"hljs-keyword\"\u003e@tailwind\u003c/span\u003e components;\n\u003cspan class=\"hljs-keyword\"\u003e@tailwind\u003c/span\u003e utilities;\n\n\u003cspan class=\"hljs-comment\"\u003e/* ...more css here */\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-ts\"\u003e\u003cspan class=\"hljs-comment\"\u003e// src/index.tsx\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;../styles/index.css\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-comment\"\u003e// ...more imports and code here\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eTailwindCSS가 추가하는 CSS 코드는 PostCSS와 \u003ccode\u003epostcss-loader\u003c/code\u003e에 의해 CSS 파일에 자동으로 추가된다. 그리고 그 CSS 파일은 위와 같이 import만 해주면 \u003ccode\u003estyle-loader\u003c/code\u003e에 의해 웹브라우저에서 html에 자동으로 추가된다.\u003c/p\u003e\n\u003cp\u003e이제 TailwindCSS, Webpack, React를 쓰기 위한 준비가 끝났다. 코딩만 하면 된다.\u003c/p\u003e\n\u003ch2 id=\"코딩\"\u003e코딩\u003c/h2\u003e\n\u003cp\u003e아래와 같이 코드를 작성해보자.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-tsx\"\u003e\u003cspan class=\"hljs-comment\"\u003e// src/index.tsx\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e React \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;react\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e ReactDOM \u003cspan class=\"hljs-keyword\"\u003efrom\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;react-dom/client\u0026#x27;\u003c/span\u003e;\n\u003cspan class=\"hljs-keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;../styles/index.css\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-function\"\u003e\u003cspan class=\"hljs-keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"hljs-title\"\u003eIndex\u003c/span\u003e(\u003cspan class=\"hljs-params\"\u003e\u003c/span\u003e) \u003c/span\u003e{\n    \u003cspan class=\"hljs-keyword\"\u003ereturn\u003c/span\u003e \u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e \u003cspan class=\"hljs-attr\"\u003eclassName\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\u0026quot;bg-gray-400\u0026quot;\u003c/span\u003e\u0026gt;\u003c/span\u003e\n      Hello, World!\n    \u003cspan class=\"hljs-tag\"\u003e\u0026lt;/\u003cspan class=\"hljs-name\"\u003ediv\u003c/span\u003e\u0026gt;\u003c/span\u003e\u003c/span\u003e\n}\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e rootDiv = \u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.createElement(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;div\u0026#x27;\u003c/span\u003e);\n\u003cspan class=\"hljs-built_in\"\u003edocument\u003c/span\u003e.body.appendChild(rootDiv);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e root = ReactDOM.createRoot(rootDiv);\nroot.render(\u003cspan class=\"xml\"\u003e\u003cspan class=\"hljs-tag\"\u003e\u0026lt;\u003cspan class=\"hljs-name\"\u003eIndex\u003c/span\u003e /\u0026gt;\u003c/span\u003e\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e이렇게 하고 \u003ccode\u003enpx webpack build\u003c/code\u003e하면 잘 빌드될 것이다. \u003ccode\u003edist/index.html\u003c/code\u003e 파일을 웹 브라우저로 열였을 때 \u0026quot;Hello, World!\u0026quot;가 뜨면 정상이다.\u003c/p\u003e\n\u003cp\u003e위와 같은 식으로 코딩하면 된다. 개발할 때는 \u003ccode\u003enpx webpack serve\u003c/code\u003e로 웹 서버를 열면 편하게 디버깅할 수 있다.\u003c/p\u003e\n"},"nextPost":{"name":"rebase_non_consecutive_commits","metadata":{"title":"떨어져 있는 커밋 합치기","subtitle":"의외로 간단한 git interactive rebase 활용법","author":"LiteHell","date":"2023-01-10T05:32:23.209Z","category":"Dev","tags":["Git"]},"rendered":"\u003ch1 id=\"들어가는-글\"\u003e들어가는 글\u003c/h1\u003e\n\u003cp\u003e글에 들어가기에 앞서, 이 글의 예시에서 rebase 전의 커밋 순서는 다음과 같다고 가정하자: ... → First commit → Secod commit → Third commit → Bugfix related to third commit → Bugfix related to second commit → Fourth commit → Second bugfix related to third commit\u003c/p\u003e\n\u003ch1 id=\"연속된-커밋-합치기\"\u003e연속된 커밋 합치기\u003c/h1\u003e\n\u003cp\u003e\u003ca href=\"https://git-scm.com/docs/git-rebase\"\u003egit rebase -i\u003c/a\u003e를 이용하면 간단하게 연속된 커밋을 합칠 수 있다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003epick 89b7a0c First commit\nreword 7d62023 Secod commit\npick d3c0a39 Third commit\nfixup 4eb60d0 Bugfix related to third commit\npick 69a520d Bugfix related to second commit\npick 584974e Fourth commit\npick 3f9e8fa Second bugfix related to third commit\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e위 to-do를 실행하면 \u003ccode\u003ereword\u003c/code\u003e로 커밋 \u003ccode\u003e7d62023\u003c/code\u003e의 메세지를 수정하게 된다. (이 예시에서는 오타를 정정했다고 가정하자.) 그리고 \u003ccode\u003efixup\u003c/code\u003e으로 연속하는 커밋 \u003ccode\u003ed3c0a39\u003c/code\u003e와 \u003ccode\u003e4eb60d0\u003c/code\u003e을 합치고, 커밋 \u003ccode\u003e4eb60d0\u003c/code\u003e의 메세지는 버려지게 된다. (메세지도 같이 합치고 싶다면 \u003ccode\u003esquash\u003c/code\u003e를 쓰면 된다.)\u003c/p\u003e\n\u003cp\u003e이를 실행하면 git 히스토리는 다음과 같이 된다: First commit → Second commit → Third commit → Bugfix related to second commit → Fourth commit → Second bugfix related to third commit\u003c/p\u003e\n\u003cp\u003e그렇다면 우리는 여기서 궁금증이 생긴다. 연속하지 않는 커밋을 합치고 싶을 땐 어떻게 하면 될까?\u003c/p\u003e\n\u003ch2 id=\"연속하지-않는-커밋-합치기\"\u003e연속하지 않는 커밋 합치기\u003c/h2\u003e\n\u003cp\u003e답은 간단하다. 그냥 to-do에서 커밋 순서를 바꾸면 된다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003epick 89b7a0c First commit\nreword 7d62023 Secod commit\nfixup 69a520d Bugfix related to second commit\npick d3c0a39 Third commit\nfixup 4eb60d0 Bugfix related to third commit\nfixup 3f9e8fa Second bugfix related to third commit\npick 584974e Fourth commit\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003einteractive rebase에서 커밋 순서를 무조건 동일하게 해야할 필요는 없다. 연속하지 않는 커밋을 합쳐야 한다면 그냥 순서를 바꿔서 합치면 된다. (이 예시에서도 \u003ccode\u003ereword\u003c/code\u003e로 커밋 \u003ccode\u003e7d62023\u003c/code\u003e의 오타를 정정했다고 가정하자.)\u003c/p\u003e\n\u003cp\u003e위와 같이 실행하면 git 히스토리는 다음과 같다: First commit → Second commit → Third commit → Fourth commit. Git History가 깔끔하게 된 것을 확인할 수 있다.\u003c/p\u003e\n"}},"__N_SSG":true},"page":"/post/[id]","query":{"id":"webpack_and_react_ssg_2"},"buildId":"tPvn0ikdnYc2gkfCdDjpk","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>